# 05_Broken Authentication Vulnerabilities

[Broken Authentication Vulnerabilities ðŸ‘‰VIDEO &#128279;](https://codered.eccouncil.org/courseVideo/Kali-for-Penetration-Testers?lessonId=74e62439-8ece-4c31-a2d2-07cdcfb84e81&finalAssessment=false)

## A2-Broken Authentication and Session Management

**A Session ID is:**

- Unique to the User
- Used for only one authenticated sessin
- Generated by the server
- Sent to the client as
  - Hidden variable,
  - HTTP cookie,
  - UR: query string (not a good practice)
- The user is expected to send back the same ID in the next request

**Session ID and HTTP**

- HTTP/s Protocol does not provide tracking of a users session
- Typically, vendors provide a built-in session tracking, which is good if used properly
- Sometimes developers will make the mistake of inventing their own session tracking
- Attackers take advantage of bad session practices to compromise passwords, keys, or authentication tokens to assume other users' identities
- Session ID is disclosed or is guessed
- An attacker using the same sessin ID has the same privileges as the real user
- Especially useful to an attacker if the session is provileged
- Allows initial access to the Web application to be combined with other attacks
- Press the back button after logout to see if you can get into the previous session
- Try to hit the URL directly after logging out to check if you are able to access that page
- Check for the presence of session-related information in the URLs. Try manipulating them to check if you are able to ride someone else's session
- Try finding the credentials in the source code. Right click on the page and hit view source. Sometimes coders **hardcode** the credentials for easy access which sometimes remain there unidentified
- Use **long complex random** session ID that cannot be guessed
- Entire session shold be transmitted via HTTPS to prevent disclosure of the session ID. (Not just the authentication)
- User **Secure** Cookies
- Session ID should expire and/or **time-out** on the server when idle or on logout.
- Consider regenerating a new session upon successful authentication or privilege level change.
- A URL query string should not be used for Session ID or any User/Session information
- Use multifactor authentication
